#to create new token

kubectl create token backstage -n default
eyJhbGciOiJSUzI1NiIsImtpZCI6InFmb3loR2x1MXd3TVZFWDFSWEhQb2FKYVRBN0tDVFozVkhfbExCNG15WjQifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiXSwiZXhwIjoxNzcwNDczMTY2LCJpYXQiOjE3NzA0Njk1NjYsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwianRpIjoiYjU5OGY3ODQtZjk0Mi00YmIwLTlkODQtYjU4NWRmZmNmMWIyIiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZWZhdWx0Iiwic2VydmljZWFjY291bnQiOnsibmFtZSI6ImJhY2tzdGFnZSIsInVpZCI6IjBhZjBkNmM1LTZlN2EtNDgwNy1iZWQxLWNkMjA4NThjOWQzOCJ9fSwibmJmIjoxNzcwNDY5NTY2LCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDpiYWNrc3RhZ2UifQ.GDKMVx-nMHj6OrCWOkmLG3BsPkrf49sgXh8n7gMmieXSDpy1EVJAXEMguvtXc8o29FkLTNBogQgBM61gTGyOrEP2YdO72esj19_8Qtw9rgZ0SlA-h2E0TSuMpDxH93grQRMI1FJRXZgGF_Imu3t_YOddjj5_4KNxxZ7pgsng42RNesTe17KiAeByrlVH1dBqKKTAmueYBkGjDYnZ87M5tt32SvtWi295ip7g7Cw-dd8yL6SqJk8Zam-EFIQBSdr5HoAg2vHuL5wYFyWwAZH0TkCzNTXUzH1JdUAsm2HEo0dv4ka8iz1RgmhaRTc8cAn-SV-aUd9bfFs42cAcP4UW8A
export K8S_SA_TOKEN=eyJhbGciOiJSUzI1NiIsImtpZCI6InFmb3loR2x1MXd3TVZFWDFSWEhQb2FKYVRBN0tDVFozVkhfbExCNG15WjQifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiXSwiZXhwIjoxNzcwNDczMTY2LCJpYXQiOjE3NzA0Njk1NjYsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwianRpIjoiYjU5OGY3ODQtZjk0Mi00YmIwLTlkODQtYjU4NWRmZmNmMWIyIiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZWZhdWx0Iiwic2VydmljZWFjY291bnQiOnsibmFtZSI6ImJhY2tzdGFnZSIsInVpZCI6IjBhZjBkNmM1LTZlN2EtNDgwNy1iZWQxLWNkMjA4NThjOWQzOCJ9fSwibmJmIjoxNzcwNDY5NTY2LCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDpiYWNrc3RhZ2UifQ.GDKMVx-nMHj6OrCWOkmLG3BsPkrf49sgXh8n7gMmieXSDpy1EVJAXEMguvtXc8o29FkLTNBogQgBM61gTGyOrEP2YdO72esj19_8Qtw9rgZ0SlA-h2E0TSuMpDxH93grQRMI1FJRXZgGF_Imu3t_YOddjj5_4KNxxZ7pgsng42RNesTe17KiAeByrlVH1dBqKKTAmueYBkGjDYnZ87M5tt32SvtWi295ip7g7Cw-dd8yL6SqJk8Zam-EFIQBSdr5HoAg2vHuL5wYFyWwAZH0TkCzNTXUzH1JdUAsm2HEo0dv4ka8iz1RgmhaRTc8cAn-SV-aUd9bfFs42cAcP4UW8A



#Kubernetes plugin to work we
under label below app
backstage.io/kubernetes-id: <name should match catolog name>
  labels:
    app: cafestatic
    backstage.io/kubernetes-id: cafestatic
  name: cafestatic


KUBE_EDITOR="nano" kubectl edit deployment cafestatic -n default
kubectl rollout restart deployment cafestatic -n default


kubectl get serviceaccount backstage -n default
kubectl get serviceaccount backstage -n default
kubectl create token backstage -n default
kubectl --token=<token> get pods -A
export K8S_SA_TOKEN=<token>

other commands
  353  kubectl create clusterrolebinding backstage-admin   --clusterrole=cluster-admin   --serviceaccount=default:backstage
  354  kubectl get clusterrolebinding backstage-admin -o yaml
  355  kubectl delete clusterrolebinding backstage-admin
  356  kubectl create clusterrolebinding backstage-admin   --clusterrole=cluster-admin   --serviceaccount=default:backstage
  357  kubectl get clusterrolebinding backstage-admin -o yaml
370  kubectl auth can-i list pods --as=system:serviceaccount:default:backstage 
-o/p yes
  371  kubectl auth can-i list services --as=system:serviceaccount:default:backstage 
o/p yes
  372  echo $K8S_SA_TOKEN | wc -c
o/p !=0



to check lables
  360  kubectl get pod demo-app-59f4bd8f8c-2b5sn -n default --show-labels
  361  kubectl get pod -n default --show-labels | grep cafestatic
  362  kubectl get deployment cafestatic -n default --show-labels




